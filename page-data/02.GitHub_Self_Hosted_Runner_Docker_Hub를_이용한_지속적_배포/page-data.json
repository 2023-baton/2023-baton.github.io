{"componentChunkName":"component---src-templates-post-jsx","path":"/02.GitHub_Self_Hosted_Runner_Docker_Hubë¥¼_ì´ìš©í•œ_ì§€ì†ì _ë°°í¬/","result":{"data":{"site":{"siteMetadata":{"title":"baton"}},"markdownRemark":{"id":"40840f5b-df15-575c-a7dc-b4ef6aaf7eec","excerpt":"ğŸ’¬ ê°œìš” ë¨¼ì € ì§€ì†ì  ë°°í¬(CD, Continuous Deploy)ë¥¼ êµ¬ì¶•í•˜ê¸° ìœ„í•´ì„œ ë‹¤ìŒê³¼ ê°™ì€ ê¸°ìˆ ì„ ì„ íƒí–ˆìŠµë‹ˆë‹¤. GitHub Self Hosted Runner : í˜„ì¬ í´ë¼ìš°ë“œ ìƒí™©ì— ì í•©í•˜ë‹¤. Docker Hub : EC2 ë‚´ë¶€ì—ì„œ ìŠ¤í”„ë§ í”„ë¡œì íŠ¸ê°€ ë¹Œë“œ(build)ëœ ì´ë¯¸ì§€(Image)ë¥¼ ê°€ì ¸ì™€ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤. image âœ… GitHub Seâ€¦","html":"<h2>ğŸ’¬ ê°œìš”</h2>\n<p>ë¨¼ì € ì§€ì†ì  ë°°í¬(CD, Continuous Deploy)ë¥¼ êµ¬ì¶•í•˜ê¸° ìœ„í•´ì„œ ë‹¤ìŒê³¼ ê°™ì€ ê¸°ìˆ ì„ ì„ íƒí–ˆìŠµë‹ˆë‹¤.</p>\n<ul>\n<li>GitHub Self Hosted Runner : í˜„ì¬ í´ë¼ìš°ë“œ ìƒí™©ì— ì í•©í•˜ë‹¤.</li>\n<li>Docker Hub : EC2 ë‚´ë¶€ì—ì„œ ìŠ¤í”„ë§ í”„ë¡œì íŠ¸ê°€ ë¹Œë“œ(build)ëœ ì´ë¯¸ì§€(Image)ë¥¼ ê°€ì ¸ì™€ ì‹¤í–‰í•  ìˆ˜ ìˆë‹¤.</li>\n</ul>\n<p><img src=\"https://github.com/2023-baton/2023-baton.github.io/assets/82203978/ae049740-d32f-4aac-9d4d-8c20ba042e11\" alt=\"image\"></p>\n<br>\n<br>\n<br>\n<h2><strong>âœ… GitHub Self Hosted Runner</strong>ë¥¼ ì„ íƒí•œ ì´ìœ </h2>\n<p>í˜„ì¬ ì§„í–‰í•˜ê³  ìˆëŠ” í”„ë¡œì íŠ¸ì˜ í´ë¼ìš°ë“œ í™˜ê²½ì— ê°€ì¥ ì í•©í•˜ë‹¤ê³  ëŠê¼ˆë‹¤.</p>\n<p>ì‚¬ìš©í•˜ê³  ìˆëŠ” EC2ì˜ vpc í™˜ê²½ì€ ì™¸ë¶€ì—ì„œ ë‚´ë¶€ë¡œ ë“¤ì–´ì˜¬ ìˆ˜ ìˆëŠ” ipì™€ portê°€ ì œí•œëœ ìƒíƒœì˜€ë‹¤.</p>\n<p>ë•Œë¬¸ì— GitHub Actionsì˜ ì›Œí¬í”Œë¡œìš°(workflow)ë¥¼ ì´ìš©í•˜ì—¬ scp ëª…ë ¹ì–´ë¡œ ë¹Œë“œëœ jarë¥¼ ì „ì†¡í•˜ê±°ë‚˜ AWSì— ì ‘ê·¼í•´ì„œ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì§ì ‘ ì‹¤í–‰í•˜ëŠ” ê²ƒì´ ë¶ˆê°€ëŠ¥í–ˆë‹¤.</p>\n<p>ì¦‰, EC2 ë‚´ë¶€ì—ì„œ ì§€ì†ì  ë°°í¬ë¥¼ ì§„í–‰í•˜ê¸° ìœ„í•´ì„œëŠ” EC2 ë‚´ë¶€ì—ì„œ ì™¸ë¶€ë¡œ ì ‘ê·¼í•˜ëŠ” ë°©ì‹ì´ í•„ìš”í–ˆë‹¤.</p>\n<p>ì´ ë•Œ ì‚¬ìš©í•´ë³¸ ê²½í—˜ì´ ìˆëŠ” ë„êµ¬ëŠ” ë‘ ê°€ì§€ì˜€ëŠ”ë°</p>\n<p>ë°”ë¡œ Jenkinsì™€ GitHub Self Hosted Runner ì˜€ê³  ë‚˜ëŠ” í›„ìì¸ GitHubë¥¼ ì„ íƒí–ˆë‹¤.</p>\n<p>Jenkinsì— ë¹„í•´ ëŸ¬ë‹ ì»¤ë¸Œê°€ ì ê³  GitHubì™€ ì—°ë™ì´ ì˜ë˜ì–´ ìˆì–´ ë¬¸ì œ í•´ê²°ì´ ì‰½ê¸° ë•Œë¬¸ì´ë‹¤.</p>\n<p>Jenkinsê°€ í•„ìš”í•œ ìì›ë³´ë‹¤ GitHub Self Hosted Runnerê°€ ë” ì ë‹¤ëŠ” ì¥ì ì„ ê°€ì§€ê³  ìˆë‹¤.</p>\n<p>ë˜í•œ ê°™ì€ í”„ë¡œì íŠ¸ë¥¼ ì§„í–‰í•˜ê³  ìˆëŠ” íŒ€ì›ë“¤ì—ê²Œ GitHubë¥¼ ì„¤ëª…í•˜ì—¬ ê¸°ìˆ ì„ ì „íŒŒí•˜ëŠ” ê²ƒì´ Jenkins ë³´ë‹¤ ë” ì‰½ë‹¤ëŠ” ê²ƒë„ ì„ íƒí•œ ì´ìœ  ì¤‘ í•˜ë‚˜ë‹¤.</p>\n<br>\n<br>\n<br>\n<h2><strong>âœ… ğŸ³ Docker Hub</strong>ë¥¼ ì„ íƒí•œ ì´ìœ </h2>\n<p>AWSì—ì„œ EC2ë¥¼ ë„ì–´ ì‚¬ìš©í•˜ê³  ìˆëŠ” ìƒíƒœì—ì„œ ìŠ¤í”„ë§ í”„ë¡œì íŠ¸ë¥¼ í´ë¡  ë°›ì•„ ë¹Œë“œí•˜ëŠ” ê²½ìš° EC2 ë©”ëª¨ë¦¬ê°€ ë¶€ì¡±í•´ì§ˆ ìˆ˜ë„ ìˆë‹¤.</p>\n<p>ì´ëŸ¬í•œ ìœ„í—˜ì„±ì„ ì¤„ì´ê¸° ìœ„í•´ì„œ ë¯¸ë¦¬ ë¹Œë“œëœ jar íŒŒì¼ì„ ê°€ì ¸ì™€ì„œ ì‹¤í–‰ì‹œí‚¤ë„ë¡ í–ˆë‹¤.</p>\n<p>í•˜ì§€ë§Œ í˜„ì¬ í´ë¼ìš°ë“œ í™˜ê²½ì€ ë¹Œë“œëœ jarë¥¼ ë°”ë¡œ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ë‹¤.</p>\n<p>AWSì—ì„œ ì œê³µí•˜ëŠ” S3ì™€ ê°™ì€ ê¸°ìˆ ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  jar íŒŒì¼ì„ ë‹¤ìš´ë°›ì•„ ì‹¤í–‰ì‹œì¼œì•¼ í–ˆë‹¤.</p>\n<p>ë˜í•œ ì €í¬ëŠ” í•˜ë‚˜ì˜ EC2ì—ì„œ React, Nginx, Springì„ ê°™ì´ ë„ì›Œ ë†“ì„ê±°ê¸° ë•Œë¬¸ì— ì´í›„ì— ê¼¬ì´ëŠ” ê²ƒì„ ë°©ì§€í•˜ê¸° ìœ„í•´ í™˜ê²½ì„ ë…ë¦½ì ìœ¼ë¡œ ê°€ì ¸ê°ˆ ìˆ˜ ìˆì—ˆìœ¼ë©´ í–ˆë‹¤.</p>\n<p>ì´ëŸ¬í•œ ìƒí™©ì„ ë´¤ì„ ë•Œ ì»¨í…Œì´ë„ˆë¡œ í™˜ê²½ì„ ì œê³µí•´ì£¼ë©´ì„œ ë¹Œë“œëœ ì´ë¯¸ì§€(image)ë¥¼ í’€(pull)ë°›ì•„ ì„œë²„ë¥¼ ì‹¤í–‰ì‹œí‚¬ ìˆ˜ ìˆëŠ” ë„ì»¤(ğŸ³ Docker)ë¥¼ ì„ íƒí•˜ê¸°ë¡œ í–ˆë‹¤.</p>\n<blockquote>\n<p>ê¸°ìˆ ì´ ì •í•´ì¡Œê³  ëŒ€ëµì ì¸ í”Œë¡œìš°ë„ ë‚˜ì™”ë‹¤.<br>\nğŸ¤” ê·¸ë ‡ë‹¤ë©´ ì´ì œ ë¬´ìŠ¨ ì¼ì„ í•´ì•¼ í• ê¹Œ?</p>\n</blockquote>\n<p>ì´ë¡ ì ìœ¼ë¡œ í˜„ì¬ í”Œë¡œìš°ì— ëŒ€í•´ ì´í•´ëŠ” í•  ìˆ˜ ìˆì—ˆì§€ë§Œ ì‹¤ì œë¡œ ê¸°ìˆ ì„ ì‚¬ìš©í•´ë³¸ì ì€ ì—†ê¸° ë•Œë¬¸ì— ë¨¼ì € ê¸°ì¡´ í”Œë¡œìš°ë¥¼ ë‹¤ì‹œ í•œ ë²ˆ ì •ë¦¬í•˜ë©´ì„œ í•´ì•¼í•  ì¼ì„ ì²´í¬ë¦¬ìŠ¤íŠ¸ë¡œ ë§Œë“¤ì—ˆë‹¤.</p>\n<p>ğŸ’¬ ë¨¼ì € í”Œë¡œìš°ë¥¼ ì •ë¦¬í•´ë³´ì.</p>\n<ul>\n<li>GitHub Repositoryì˜ ë¸Œëœì¹˜ì— push ë˜ì—ˆì„ ë•Œ GitHubê°€ ì¸ì§€í•˜ê³  ìŠ¤í”„ë§ í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œ(build)í•œë‹¤.</li>\n<li>ë¹Œë“œëœ jaríŒŒì¼ì„ ë„ì»¤ ì´ë¯¸ì§€(Docker Image)ë¡œ ë§Œë“¤ì–´ ë„ì»¤ í—ˆë¸Œ(Docker Hub)ì— pushí•œë‹¤.</li>\n<li>EC2ì— ë„ìš´ GitHub Self Hosted Runnerê°€ ë„ì»¤ í—ˆë¸Œê°€ ì—…ë°ì´íŠ¸ ë˜ì—ˆë‹¤ëŠ” ê²ƒì„ í™•ì¸í•˜ê³  ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ìë™ìœ¼ë¡œ pullí•œë‹¤.</li>\n<li>EC2ì— ìˆëŠ” ë„ì»¤ ì´ë¯¸ì§€ë¥¼ ì»¨í…Œì´ë„ˆë¡œ ë„ì›Œ ìŠ¤í”„ë§ ì„œë²„ë¥¼ ì‹¤í–‰ì‹œí‚¨ë‹¤.</li>\n</ul>\n<p>í”Œë¡œìš°ë¥¼ ì‘ì„±í•˜ê³  íë¦„ì€ ì´í•´ ë˜ì—ˆë‹¤. ì´ì œ ì²´í¬ë¦¬ìŠ¤íŠ¸ë¥¼ ì‘ì„±í•˜ë©´ì„œ êµ¬ì²´í™” ì‹œì¼œë³´ì.</p>\n<p>âœ”ï¸ ì²´í¬ë¦¬ìŠ¤íŠ¸</p>\n<p>- ê¹ƒí—ˆë¸Œê°€ ì œê³µí•˜ëŠ” í´ë¼ìš°ë“œ í™˜ê²½ì—ì„œ í•  ì¼</p>\n<p>Â  - GitHub Repository í´ë¡ </p>\n<p>Â  - JDK 17 í™˜ê²½ ì„¤ì •</p>\n<p>Â  - Gradle Build</p>\n<p>Â  - Docker Buildx</p>\n<p>Â  - Docker Login</p>\n<p>Â  - Docker Image Build</p>\n<p>Â  - Docker Hub Push</p>\n<p>- EC2 ë‚´ë¶€ì— ìˆëŠ” GitHub Self Hosted Runnerê°€ í•  ì¼Â </p>\n<p>Â  - Docker Login</p>\n<p>Â  - Docker Pull</p>\n<p>Â  - Docker Run</p>\n<p>ì´ì œ ì´ íë¦„ì„ ë”°ë¼ê°€ë³´ì.</p>\n<br>\n<br>\n<br>\n<h2>ğŸŸ© ê¹ƒí—ˆë¸Œê°€ ì œê³µí•˜ëŠ” í´ë¼ìš°ë“œ í™˜ê²½ì—ì„œ í•  ì¼</h2>\n<p>ë¨¼ì € '<strong>ê¹ƒí—ˆë¸Œê°€ ì œê³µí•˜ëŠ” í´ë¼ìš°ë“œ í™˜ê²½ì—ì„œ í•  ì¼</strong>'ì„ ëë‚´ë³´ì.</p>\n<h3>01. on: push : branches: [\"dev/BE\"]</h3>\n<p>workflowë¥¼ íŠ¸ë¦¬ê±°(trigger)í•˜ê¸° ìœ„í•´ì„œëŠ” ì´ë²¤íŠ¸(event)ë¥¼ ë°œìƒì‹œì¼œì•¼ í•œë‹¤.</p>\n<p>í˜„ì¬ 'dev/BE' ë¸Œëœì¹˜ì— push ì´ë²¤íŠ¸ê°€ ë°œìƒí–ˆì„ ë•Œ workflowê°€ ë™ì‘í•´ì•¼ í•œë‹¤.</p>\n<p>ê¹ƒí—ˆë¸Œì—ì„œëŠ” ì´ëŸ¬í•œ push ì´ë²¤íŠ¸ê°€ ë°œìƒí–ˆì„ ë•Œ workflowê°€ íŠ¸ë¦¬ê±°í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •í•˜ëŠ” ëª…ë ¹ì–´ë¥¼ ë¬¸ì„œì— ì •ë¦¬í•´ë‘ì—ˆë‹¤.</p>\n<p>ì‚¬ìš©ì ì…ì¥ì—ì„œëŠ” workflowì— ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•˜ë©´ ëœë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">on:\n  push:\n    branches: [ \"dev/BE\" ]</code></pre></div>\n<p>Â <a href=\"https://docs.github.com/ko/actions/using-workflows/events-that-trigger-workflows#push\">ì›Œí¬í”Œë¡œë¥¼ íŠ¸ë¦¬ê±°í•˜ëŠ” ì´ë²¤íŠ¸ - GitHub Docs</a></p>\n<br>\n<br>\n<h3>02. jobs: build: runs-on: ubuntu-latest</h3>\n<p>workflowë¥¼ ì‹¤í–‰í•  ìˆ˜ ìˆëŠ” í™˜ê²½ì„ ëŸ¬ë„ˆ(runner)ë¼ê³  í•œë‹¤.</p>\n<p>ê·¸ë¦¬ê³  workflow ë‚´ë¶€ì— ì‘ì—…(job)ë“¤ì„ ì§„í–‰í•˜ê¸° ìœ„í•´ì„œëŠ” ìš´ì˜ì²´ì œì™€ ê°™ì€ í™˜ê²½ì„ ë§Œë“¤ì–´ì¤˜ì•¼ í•œë‹¤.</p>\n<p>MacOS, Window í™˜ê²½ì—ì„œ ì‘ì—…ì„ ì§„í–‰í•  ìˆ˜ ìˆì§€ë§Œ EC2ê°€ Linuxë¡œ ë„ì–´ì ¸ìˆê¸° ë•Œë¬¸ì— Ubuntuë¥¼ ì´ìš©í•˜ê¸°ë¡œ í•œë‹¤.</p>\n<p>workflowì—ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•˜ë©´ ëœë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">jobs:\n  build:\n    runs-on: ubuntu-latest</code></pre></div>\n<p>Â <a href=\"https://docs.github.com/ko/actions/using-github-hosted-runners/about-github-hosted-runners\">GitHub í˜¸ìŠ¤íŒ… ì‹¤í–‰ê¸° ì •ë³´ - GitHub Docs</a></p>\n<br>\n<br>\n<h3>03. uses: actions/checkout</h3>\n<p>GitHub Actionsë¥¼ ì‚¬ìš©í•´ì„œ ìŠ¤í”„ë§ í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œí•˜ë ¤ë©´ ë¨¼ì € ê¸°ë³¸ì ì¸ íŒŒì¼ì„ í´ë¡ ë°›ì•„ì•¼ í•œë‹¤.</p>\n<p>ì´ ìŠ¤í…ì„ í•˜ë‚˜ì˜ ì•¡ì…˜(Action)ìœ¼ë¡œ GitHub Marketplaceì—ì„œ ì œê³µí•˜ê³  ìˆë‹¤.</p>\n<p>workflowì—ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•˜ë©´ ëœë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">on:\n  push:\n    branches: [ \"dev/BE\" ]\n\njobs:\n  build:\n    runs-on: ubuntu-latest\n\n\n# ìœ„ì— ì íŒ ë‚´ìš©ì€ depthë¥¼ ë³´ì—¬ì£¼ê¸° ìœ„í•´ ë”°ë¡œ ë¶„ë¦¬í•˜ì§€ ì•Šì•˜ë‹¤.\n    steps:\n      - name: Checkout repository\n        uses: actions/checkout@v3</code></pre></div>\n<p>Â <a href=\"https://github.com/marketplace/actions/checkout\">Checkout - GitHub Marketplace</a></p>\n<br>\n<br>\n<h3>04. uses:Â actions/setup-java</h3>\n<p>JDK 17ë¥¼ ì‚¬ìš©í•˜ê³  ìˆëŠ” ìŠ¤í”„ë§ í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œí•˜ê¸° ìœ„í•´ì„œ JDKë¥¼ ì„¤ì¹˜í•˜ëŠ” ì•¡ì…˜ì„ ì‚¬ìš©í•œë‹¤.</p>\n<p>workflowì—ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•˜ë©´ ëœë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">      - name: Set up JDK 17\n        uses: actions/setup-java@v3\n        with:\n          java-version: '17'\n          distribution: 'corretto'</code></pre></div>\n<p>Â <a href=\"https://github.com/marketplace/actions/setup-java-jdk\">Setup Java JDK - GitHub Marketplace</a></p>\n<br>\n<br>\n<h3>05. uses: gradle/gradle-build-action</h3>\n<p>Gradleë¡œ ìŠ¤í”„ë§ í”„ë¡œì íŠ¸ë¥¼ ê´€ë¦¬í•˜ê³  ìˆë‹¤. Gradleì„ í†µí•´ì„œ í”„ë¡œì íŠ¸ë¥¼ ë¹Œë“œí•˜ë ¤ê³  í•œë‹¤.</p>\n<p>Â workflowì—ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•˜ë©´ ëœë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">      - name: Build with Gradle\n        uses: gradle/gradle-build-action@v2.6.0\n      - name: Execute Gradle build\n        run: |\n          cd backend/baton\n          ./gradlew build</code></pre></div>\n<p>Â <a href=\"https://github.com/marketplace/actions/gradle-build-action\">Gradle Build Action - GitHub Marketplace</a></p>\n<br>\n<br>\n<h3>06. uses: docker/login-action</h3>\n<p>Docker Hubì— ë§Œë“  ì´ë¯¸ì§€ë¥¼ í‘¸ì‰¬í•˜ê¸° ìœ„í•´ì„œ ê³„ì •ìœ¼ë¡œ ë¡œê·¸ì¸í•œë‹¤.</p>\n<p>Dockerì— ë¡œê·¸ì¸í•˜ê³  ê³„ì •ì—ì„œ í† í°ì„ ë§Œë“¤ì–´ì•¼ ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ë‹¤.</p>\n<p>ì•„ë˜ëŠ” ì•„ì§ í† í°ì„ ë§Œë“¤ì§€ ì•Šì€ ìƒíƒœì˜ í˜ì´ì§€ë‹¤.</p>\n<p><img src=\"https://github.com/2023-baton/2023-baton.github.io/assets/82203978/b5684ce0-98a7-4a58-af17-8f7829338707\" alt=\"image\"></p>\n<p>í† í°ì„ ë§Œë“¤ì–´ì„œ GitHub Secretì— ë“±ë¡í•´ì„œ workflowì—ì„œ ì‚¬ìš©í•˜ë„ë¡ ì„¤ì •í–ˆë‹¤.</p>\n<p><img src=\"https://github.com/2023-baton/2023-baton.github.io/assets/82203978/42caa09a-f2b3-4e0d-b778-b760d999555d\" alt=\"image\"></p>\n<p>ì°¸ê³ ë¡œÂ  workflowì—ì„œ secretì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” `${{ secrets.ì´ë¦„ }}`ì™€ ê°™ì€ í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•˜ë©´ ëœë‹¤.</p>\n<p>workflowì—ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•˜ë©´ ëœë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">      - name: Login to Docker Hub\n        uses: docker/login-action@v2.2.0\n        with:\n          username: ${{ secrets.DOCKERHUB_DEV_USERNAME }}\n          password: ${{ secrets.DOCKERHUB_DEV_TOKEN }}</code></pre></div>\n<p>Â <a href=\"https://hub.docker.com/\">Docker Hub Container Image Library</a></p>\n<p>Â <a href=\"https://github.com/marketplace/actions/docker-login\">Docker Login - GitHub Marketplace</a></p>\n<br>\n<br>\n<h3>07. run: docker build</h3>\n<p>Docker Imageë¥¼ ë§Œë“¤ê¸° ìœ„í•´ì„œ docker build ëª…ë ¹ì–´ë¥¼ ì‘ì„±í•œë‹¤.</p>\n<p>í”„ë¡œì íŠ¸ ìµœìƒë‹¨ íŒ¨í‚¤ì§€ì— ë§Œë“¤ì–´ ë†“ì€ Dockerfileì„ ì‹¤í–‰í•  ìˆ˜ ìˆë„ë¡ ëª…ì‹œí–ˆë‹¤.</p>\n<p>Dockerfile ë‚´ìš©ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.<br>\nEC2 í™˜ê²½ì€ arm64v8ì´ë‹¤.</p>\n<p>JDKëŠ” Corretto 17ì„ ì´ìš©í–ˆë‹¤.</p>\n<p>jarë¥¼ ë³µì‚¬ê³  ìŠ¤í”„ë§ í”„ë¡œí•„ í™˜ê²½ ë³€ìˆ˜ë¥¼ devë¡œ ë‘ê³  ìŠ¤í”„ë§ ì„œë²„ë¥¼ ì‹¤í–‰ì‹œí‚¨ë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">FROM arm64v8/amazoncorretto:17\n\nWORKDIR /app\n\nCOPY ./build/libs/baton-0.0.1-SNAPSHOT.jar /app/baton.jar\n\nCMD [\"java\", \"-jar\", \"-Dspring.profiles.active=dev\", \"baton.jar\"]</code></pre></div>\n<p>workflowì—ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•˜ë©´ ëœë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">      - name: Docker Image Build\n        run: |\n          cd backend/baton\n          docker build --platform linux/arm64/v8 -t 2023baton/2023baton -f Dockerfile-dev .</code></pre></div>\n<h3>08. run: docker push</h3>\n<p>ì´ì œ ì´ë¯¸ì§€ë¡œ ë§Œë“  ìŠ¤í”„ë§ í”„ë¡œì íŠ¸ë¥¼ Docker Hubì— pushí•˜ì.</p>\n<p>ë¨¼ì € Dockerì—ì„œ Repositoryë¥¼ ë§Œë“¤ì.</p>\n<p>workflowì— `docker push 2023baton/2023baton` ì´ë¼ëŠ” ëª…ë ¹ì–´ê°€ ëª…ì‹œë˜ì–´ ìˆëŠ”ë°</p>\n<p>`docker push {docker_username}/{docker_repository_name}` í˜•íƒœë¡œ ëª…ì‹œí•˜ë©´ ëœë‹¤.</p>\n<p>workflowì—ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•˜ë©´ ëœë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">      - name: Docker Hub Push\n        run: docker push 2023baton/2023baton</code></pre></div>\n<h3>09. `<strong>ê¹ƒí—ˆë¸Œê°€ ì œê³µí•˜ëŠ” í´ë¼ìš°ë“œ í™˜ê²½ì—ì„œ í•  ì¼`</strong> workflow ì¢…í•©</h3>\n<p><img src=\"https://github.com/2023-baton/2023-baton.github.io/assets/82203978/5140c7d1-362d-4ac7-a106-abd3dc646f65\" alt=\"image\"></p>\n<p>01 ~ 08 ê¹Œì§€ ì†Œê°œí•œ ìŠ¤í…ë“¤ì„ í•©ì³ í•˜ë‚˜ì˜ ì›Œí¬í”Œë¡œìš°ë¥¼ ì‘ì„±í•˜ë©´ ì•„ë˜ì™€ ê°™ë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">on:\n  push:\n    branches: [ \"dev/BE\" ]\n\njobs:\n  build:\n    runs-on: ubuntu-latest\n\n    steps:\n      - name: Checkout repository\n        uses: actions/checkout@v3\n\n      - name: Set up JDK 17\n        uses: actions/setup-java@v3\n        with:\n          java-version: '17'\n          distribution: 'corretto'\n\n      - name: Build with Gradle\n        uses: gradle/gradle-build-action@v2.6.0\n      - name: Execute Gradle build\n        run: |\n          cd backend/baton\n          ./gradlew build\n\n      - name: Login to Docker Hub\n        uses: docker/login-action@v2.2.0\n        with:\n          username: ${{ secrets.DOCKERHUB_DEV_USERNAME }}\n          password: ${{ secrets.DOCKERHUB_DEV_TOKEN }}\n\n      - name: Docker Image Build\n        run: |\n          cd backend/baton\n          docker build --platform linux/arm64/v8 -t 2023baton/2023baton -f Dockerfile-dev .\n\n      - name: Docker Hub Push\n        run: docker push 2023baton/2023baton</code></pre></div>\n<br>\n<br>\n<br>\n<h2>ğŸŸ© EC2 ë‚´ë¶€ì— ìˆëŠ” GitHub Self Hosted Runnerê°€ í•  ì¼</h2>\n<p>ì´ì œ Docker Hubì— ìŠ¤í”„ë§ ì´ë¯¸ì§€ê¹Œì§€ ì˜¬ë¼ê°€ ìˆë‹¤.</p>\n<p>EC2ì— ìˆëŠ” GitHub Self Hosted Runnerê°€ Docker Hubì— ì´ë¯¸ì§€ë¥¼ pullí•´ì„œ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•˜ë„ë¡ workflowë¥¼ ì‘ì„±í•˜ì.</p>\n<h3>01. GitHub Self Hosted Runner ì„¤ì¹˜</h3>\n<p>Repositoryì˜ Settinggsì— ë“¤ì–´ê°€ Actions íƒ­ì— Runnersë¥¼ ë“¤ì–´ê°€ì„œ `New self-hosted runner` ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ëª…ë ¹ì–´ë¥¼ ë³´ì—¬ì¤€ë‹¤.</p>\n<p><img src=\"https://github.com/2023-baton/2023-baton.github.io/assets/82203978/d29a74d2-cd05-482d-9570-8daff8d0e414\" alt=\"image\"></p>\n<p>ë‹¤ìŒê³¼ ê°™ì´ Runner Imageë¥¼ ê³ ë¥¼ ìˆ˜ ìˆê³  ë‹¤ìš´ë¡œë“œ, ì„¤ì •, ì‹¤í–‰ ë“± ì˜ ì •ë³´ë¥¼ ì „ë¶€ ì œê³µí•´ì£¼ê¸° ë•Œë¬¸ì— EC2ì— ëª…ë ¹ì–´ë¥¼ ì‹¤í–‰í•˜ë©´ ëì´ë‹¤.</p>\n<p><img src=\"https://github.com/2023-baton/2023-baton.github.io/assets/82203978/9f8cdb9e-0b19-4027-bf66-4ee4350e3bd9\" alt=\"image\"></p>\n<h3>02. runs-on: [self-hosted]</h3>\n<p>EC2ì— GitHub Self Hosted Runnerë¥¼ ì„¤ì¹˜í–ˆë‹¤ë©´ workflowë¥¼ ì‘ì„±í•´ì£¼ì.</p>\n<p>`self-hosted`ë¼ê³  ì‘ì„±í•˜ë©´ ìš°ë¦¬ê°€ ë°©ê¸ˆ ë§Œë“  runnerë¥¼ ì„ íƒí•˜ê²Œ ëœë‹¤.</p>\n<p>ë§Œì•½ ë‹¤ìŒê³¼ ê°™ì´ Self-Hosted Runnerê°€ ë‘ ê°œ ì´ìƒì´ë¼ë©´ ë¼ë²¨(label)ì„ ë„£ì–´ì„œ êµ¬ë¶„í•  ìˆ˜ ìˆë‹¤.</p>\n<p><img src=\"https://github.com/2023-baton/2023-baton.github.io/assets/82203978/d18331d0-15bf-4b3c-ac19-817065076ac7\" alt=\"image\"></p>\n<p>ë‹¤ìŒê³¼ ê°™ì€ ìƒí™©ì—ì„œ ë‚˜ëŠ” deploy í™˜ê²½ì—ì„œëŠ” deployë¼ëŠ” ë¼ë²¨ì„ ë¶™ì˜€ë‹¤.</p>\n<p><img src=\"https://github.com/2023-baton/2023-baton.github.io/assets/82203978/b5340890-b187-44d1-bc0a-c9a86e08e93b\" alt=\"image\"></p>\n<p>runnerê°€ 1ê°œ ì¼ ë•ŒëŠ” workflowëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•  ìˆ˜ ìˆë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">jobs:\n  dev-deploy:\n    runs-on: self-hosted</code></pre></div>\n<p>runnerê°€ 2ê°œ ì´ìƒì¼ ë•ŒëŠ” êµ¬ë¶„ì§€ì„ ìˆ˜ ìˆì–´ì•¼ ë˜ê¸° ë•Œë¬¸ì— ì•„ë˜ì™€ ê°™ì´ ë¼ë²¨ê¹Œì§€ ëª…ì‹œí•´ì£¼ë©´ ëœë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># Self-Hosted Runner : dev\njobs:\n  dev-deploy:\n    runs-on: [self-hosted, Linux, ARM64]</code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\"># Self-Hosted Runner : deploy \njobs:\n  dev-deploy:\n    runs-on: [self-hosted, Linux, ARM64, deploy]</code></pre></div>\n<p>í˜„ì¬ ì›Œí¬í”Œë¡œìš°ì—ì„œ ì‚¬ìš©í•˜ëŠ” Self-Hosted RunnerëŠ” devë¼ëŠ” ê²ƒì„ ìƒê°í•´ì¤¬ìœ¼ë©´ ì¢‹ê² ë‹¤.</p>\n<h3>03. needs: build</h3>\n<p>ì´ì „ì— Docker Hubì— ì´ë¯¸ì§€ë¥¼ pushí•˜ëŠ” ì‘ì—…ì´ ìˆì—ˆë‹¤.</p>\n<p>ê·¸ë¦¬ê³  ì§€ê¸ˆ ì‘ì„±í•˜ê³  ìˆëŠ” ì‘ì—…ì€ EC2ì—ì„œ Docker Hub ì´ë¯¸ì§€ë¥¼ pull ë°›ì•„ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰ì‹œí‚¤ëŠ” ê²ƒì´ë‹¤.</p>\n<p>ì´ ë•Œ ìˆœì„œë¥¼ ì •í•´ì£¼ì§€ ì•Šìœ¼ë©´ ì—…ë°ì´íŠ¸ ë˜ì§€ ì•Šì€ ì´ë¯¸ì§€ë¥¼ ë°›ì•„ ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰ì‹œí‚¬ ìˆ˜ ë„ ìˆë‹¤.</p>\n<p>ê·¸ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œ needsë¼ëŠ” í‚¤ì›Œë“œë¥¼ ë‹¬ì•„ buildë¼ëŠ” ì‘ì—…ì´ ëë‚˜ë©´ ë‹¤ìŒ ì‘ì—…ì´ ì§„í–‰ë˜ë„ë¡ ë§Œë“¤ì.</p>\n<p>workflowì—ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•˜ë©´ ëœë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">on:\n  push:\n    branches: [ \"dev/BE\" ]\n\njobs:\n  build:\n    runs-on: ubuntu-latest\n\n  deploy:\n    runs-on: [self-hosted, Linux, ARM64]\n    needs: build</code></pre></div>\n<h3>04. docker pull</h3>\n<p>ì´ì œ Docker Hubì— ë¡œê·¸ì¸í•˜ì—¬ ì´ë¯¸ì§€ë¥¼ pullí•˜ë„ë¡ í•˜ì.</p>\n<p>Docker Hubì— 2023baton ë ˆí¬ì§€í„°ë¦¬ì—ì„œ 2023baton ì´ë¯¸ì§€ë¥¼Â  pullí•œë‹¤.</p>\n<p>workflowëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•˜ë©´ ëœë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">    steps:\n      - name: Pull Latest Docker Image\n        run: |\n          sudo docker login --username ${{ secrets.DOCKERHUB_DEV_USERNAME }} --password ${{ secrets.DOCKERHUB_DEV_TOKEN }}\n          sudo docker pull 2023baton/2023baton:latest</code></pre></div>\n<h3>05. docker run</h3>\n<p>Docker Imageê°€ pull ë°›ì•„ ìµœì‹  ìƒíƒœê°€ ëœ ê²½ìš° ìŠ¤í”„ë§ Containerë¥¼ ë©ˆì¶”ê³  ì‚­ì œí•œë‹¤.</p>\n<p>ê·¸ë¦¬ê³  ë‹¤ì‹œ ìƒˆë¡œìš´ Containerë¥¼ ë„ìš°ë„ë¡ í•œë‹¤.</p>\n<p>workflowëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì‘ì„±í•˜ë©´ ëœë‹¤.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">    steps:\n      - name: Pull Latest Docker Image\n        run: |\n          sudo docker login --username ${{ secrets.DOCKERHUB_DEV_USERNAME }} --password ${{ secrets.DOCKERHUB_DEV_TOKEN }}\n          if sudo docker inspect spring-baton &amp;>/dev/null; then\n            sudo docker stop spring-baton\n            sudo docker rm -f spring-baton\n          fi\n          sudo docker pull 2023baton/2023baton:latest\n\n      - name: Docker Run\n        run: |\n          sudo docker run --name spring-baton -p 8080:8080 2023baton/2023baton:latest 1>> build.log 2>> error.log &amp;name: dev/BE CD on Push</code></pre></div>\n<h4>06. `<strong>EC2 ë‚´ë¶€ì— ìˆëŠ” GitHub Self Hosted Runnerê°€ í•  ì¼</strong>` worflow ì¢…í•©</h4>\n<p><img src=\"https://github.com/2023-baton/2023-baton.github.io/assets/82203978/675fcde0-5e8e-4bab-aca5-d47a262329f4\" alt=\"image\"></p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">  deploy:\n    runs-on: [self-hosted, Linux, ARM64]\n    needs: build\n\n    steps:\n      - name: Pull Latest Docker Image\n        run: |\n          sudo docker login --username ${{ secrets.DOCKERHUB_DEV_USERNAME }} --password ${{ secrets.DOCKERHUB_DEV_TOKEN }}\n          if sudo docker inspect spring-baton &amp;>/dev/null; then\n            sudo docker stop spring-baton\n            sudo docker rm -f spring-baton\n          fi\n          sudo docker pull 2023baton/2023baton:latest\n\n      - name: Docker Run\n        run: |\n          sudo docker run --name spring-baton -p 8080:8080 2023baton/2023baton:latest 1>> build.log 2>> error.log &amp;</code></pre></div>\n<br>\n<br>\n<br>\n<h2>ğŸŸ© ìµœì¢… ì›Œí¬í”Œë¡œìš°</h2>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">name: dev/BE CD on Push\n\non:\n  push:\n    branches: [ \"dev/BE\" ]\n\njobs:\n  build:\n    runs-on: ubuntu-latest\n\n    steps:\n      - name: Checkout repository\n        uses: actions/checkout@v3\n        with:\n          token: ${{ secrets.SUBMODULE_BE_TOKEN }}\n          submodules: recursive\n\n      - name: Set up JDK 17\n        uses: actions/setup-java@v3\n        with:\n          java-version: '17'\n          distribution: 'corretto'\n\n      - name: Build with Gradle\n        uses: gradle/gradle-build-action@v2.6.0\n      - name: Execute Gradle build\n        run: |\n          cd backend/baton\n          ./gradlew build\n\n      - name: Login to Docker Hub\n        uses: docker/login-action@v2.2.0\n        with:\n          username: ${{ secrets.DOCKERHUB_DEV_USERNAME }}\n          password: ${{ secrets.DOCKERHUB_DEV_TOKEN }}\n\n      - name: Docker Image Build\n        run: |\n          cd backend/baton\n          docker build --platform linux/arm64/v8 -t 2023baton/2023baton -f Dockerfile-dev .\n\n      - name: Docker Hub Push\n        run: docker push 2023baton/2023baton\n\n  deploy:\n    runs-on: [self-hosted, Linux, ARM64]\n    needs: build\n\n    steps:\n      - name: Pull Latest Docker Image\n        run: |\n          sudo docker login --username ${{ secrets.DOCKERHUB_DEV_USERNAME }} --password ${{ secrets.DOCKERHUB_DEV_TOKEN }}\n          if sudo docker inspect spring-baton &amp;>/dev/null; then\n            sudo docker stop spring-baton\n            sudo docker rm -f spring-baton\n          fi\n          sudo docker pull 2023baton/2023baton:latest\n\n      - name: Docker Compose\n        run: |\n          sudo docker run --name spring-baton -p 8080:8080 2023baton/2023baton:latest 1>> build.log 2>> error.log &amp;</code></pre></div>\n<p>ì´ì œ ë¸Œëœì¹˜ì— push í•  ë•Œ ë§ˆë‹¤ ìƒˆë¡œìš´ ì´ë¯¸ì§€ê°€ Docker Hubì— push ë˜ê³  Self-hostedëŠ” pull ë°›ì•„ ìƒˆë¡œìš´ ì»¨í…Œì´ë„ˆë¥¼ ë„ìš´ë‹¤.</p>","frontmatter":{"title":"ğŸ’¿ ì§€ì†ì  ë°°í¬(CD)ë¥¼ GitHub Self Hosted Runnerì™€ Docker Hubë¡œ í•´ë³´ì","date":"July 31, 2023","update":"July 31, 2023","tags":["docker","github actions","self-hosted"],"series":"CD"},"fields":{"slug":"/02.GitHub_Self_Hosted_Runner_Docker_Hubë¥¼_ì´ìš©í•œ_ì§€ì†ì _ë°°í¬/","readingTime":{"minutes":16.59}}},"seriesList":{"edges":[{"node":{"id":"40840f5b-df15-575c-a7dc-b4ef6aaf7eec","fields":{"slug":"/02.GitHub_Self_Hosted_Runner_Docker_Hubë¥¼_ì´ìš©í•œ_ì§€ì†ì _ë°°í¬/"},"frontmatter":{"title":"ğŸ’¿ ì§€ì†ì  ë°°í¬(CD)ë¥¼ GitHub Self Hosted Runnerì™€ Docker Hubë¡œ í•´ë³´ì"}}}]},"previous":{"fields":{"slug":"/first/"},"frontmatter":{"title":"ğŸ³ ë„ì»¤ë¡œ DB ê´€ë¦¬í•˜ê¸°"}},"next":{"fields":{"slug":"/03. ë„ì»¤ ì»¨í…Œì´ë„ˆ ê°„ í†µì‹  íŠ¸ëŸ¬ë¸” ìŠˆíŒ…/"},"frontmatter":{"title":"ğŸ”« ë„ì»¤ ì»¨í…Œì´ë„ˆ ê°„ í†µì‹  íŠ¸ëŸ¬ë¸” ìŠˆíŒ…"}}},"pageContext":{"id":"40840f5b-df15-575c-a7dc-b4ef6aaf7eec","series":"CD","previousPostId":"0535c63b-de00-5419-80d8-7b403e57e8b0","nextPostId":"78cd2d41-6927-5ffa-ab97-7991c0ddd912"}},"staticQueryHashes":[],"slicesMap":{}}